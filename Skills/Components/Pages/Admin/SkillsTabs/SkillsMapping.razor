<MudTabPanel Class="mark-one" Text="@Title">
    <MudContainer MaxWidth="MaxWidth.ExtraLarge">
        <MudGrid Class="mt-8" Justify="Justify.Center">
            <MudItem xs="12">
                <MudDataGrid T="SkillModel" Items="_models" Bordered Hover Outlined Filterable Striped SortMode="SortMode.Multiple" Dense FixedHeader
                             Culture="@(new CultureInfo("fr-FR"))" Height="70vh" Virtualize OverscanCount="25" QuickFilter="@QuickFilter">
                    <ToolBarContent>
                        <MudTooltip Placement="Placement.Bottom" Text="Importer (.xlsx)" Arrow>
                            <MudIconButton Icon="@IconsFF.FileExcel" Color="Color.Tertiary" />
                        </MudTooltip>
                        <MudTooltip Placement="Placement.Bottom" Text="Créer une compétence" Arrow>
                            <MudIconButton Icon="@IconsF.Add" Color="Color.Tertiary" OnClick="@(() => CreateSkillAsync())"/>
                        </MudTooltip>
                        <MudSpacer/>
                        <MudTextField T="string" @bind-Value="_search" Immediate Adornment="Adornment.Start"
                                      AdornmentIcon="@IconsF.Search" Placeholder="Rechercher" Class="flex-grow-0 mr-8 mt-0" Style="width: 400px;"/>
                    </ToolBarContent>
                    <Columns>
                        <HierarchyColumn T="SkillModel" />
                        <PropertyColumn Title="Type" Property="x => x.Type.Value"/>
                        <PropertyColumn Title="Catégorie" Property="x => x.Category.Value"/>
                        <TemplateColumn Title="Sous catégorie">
                            <CellTemplate>
                                <MudText Typo="Typo.body2">@(context.Item.SubCategory?.Value ?? string.Empty)</MudText>
                            </CellTemplate>
                        </TemplateColumn>
                        <PropertyColumn Title="Description" Property="x => x.Description"/>
                        <TemplateColumn Title="Actions" Sortable="false" Filterable="false">
                            <CellTemplate Context="row">
                                <MudTooltip Placement="Placement.Bottom" Text="Éditer" Arrow>
                                    <MudIconButton Icon="@IconsF.Edit" Size="Size.Small" Color="Color.Primary" OnClick="@(() => EditSkillAsync(row.Item))"/>
                                </MudTooltip>
                                <MudTooltip Class="ml-2" Placement="Placement.Bottom" Text="Supprimer" Arrow>
                                    <MudIconButton Class="ml-4" Icon="@IconsF.Delete" Size="Size.Small" Color="Color.Error" OnClick="@(() => DeleteSkillAsync(row.Item))"/>
                                </MudTooltip>
                            </CellTemplate>
                        </TemplateColumn>
                    </Columns>
                    <ChildRowContent>
                        <MudStack Row="false" Spacing="0">
                            <MudText Class="mark-one" Typo="Typo.h6" GutterBottom>Niveaux</MudText>
                            <MudStack Class="px-2" Row="false" Spacing="0">
                                @if (_skillTypeLevels[context.Item.Id].Any())
                                {
                                    @foreach (var typeLevel in _skillTypeLevels[context.Item.Id])
                                    {
                                        <MudStack Row Justify="Justify.FlexStart">
                                            <MudText Class="mark-one"><MudChip>@typeLevel.Level</MudChip> @typeLevel.Value</MudText>
                                        </MudStack>
                                    }
                                }
                                else
                                {
                                    <MudAlert Class="mb-1" Severity="Severity.Normal">Aucun niveau défini pour ce type de compétence.</MudAlert>
                                }
                                
                            </MudStack>
                        </MudStack>
                    </ChildRowContent>
                </MudDataGrid>
            </MudItem>
        </MudGrid>
    </MudContainer>
</MudTabPanel>