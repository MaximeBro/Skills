@inherits FullComponentBase

<MudTabPanel Text="Expériences" OnClick="@OnClick">
    <MudGrid Justify="Justify.Center" Spacing="0">
        <MudItem Class="px-2 px-md-16" xs="12">
            <MudStack Row>
                <HideableBreadcrumb Items="@_breadcrumbs" Class="open-sans" />
                <MudSpacer/>
                <MudPaper Class="my-4 px-4 py-3" Elevation="2">
                    <MudStack Row AlignItems="AlignItems.Center">
                        <MudAvatar Color="Color.Dark">@User.Name[0].ToString().ToUpper()</MudAvatar>
                        <MudStack Row="false" Spacing="0">
                            <MudText Class="open-sans-600">@User.Name</MudText>
                            <MudText Class="open-sans-600">@User.Email</MudText>
                            <MudLink Href="@($"tel:{@User.PhoneNumber}")" Color="Color.Inherit">
                                <MudText Class="open-sans-600" Typo="Typo.body2">@User.PhoneNumber</MudText>
                            </MudLink>
                        </MudStack>
                    </MudStack>
                </MudPaper>
            </MudStack>
        </MudItem>

        <MudItem Class="px-2 px-md-16" xs="12">
            <MudPaper Elevation="2">
                <MudToolBar Dense>
                    <MudTooltip Text="@SortActionText" Placement="Placement.Right" Arrow>
                        <MudIconButton Icon="@SortActionIcon" Size="Size.Small" Style="border-radius: 6px!important; padding: 4px!important;" Color="@(Layout.IsDarkMode ? Color.Default : Color.Dark)" OnClick="@OnSortChanged"/>
                    </MudTooltip>
                    <MudTooltip Class="ml-2" Text="Ajouter une expérience" Placement="Placement.Top" Arrow>
                        <MudIconButton Class="ml-4" Icon="@IconsF.AddBox" Style="border-radius: 6px!important; padding: 4px!important;" Color="Color.Tertiary" OnClick="@CreateExperienceAsync"/>
                    </MudTooltip>
                </MudToolBar>
            </MudPaper>
        </MudItem>
        
        @foreach (var experience in _experiences)
        {
            <MudItem Class="px-2 px-md-16 mt-3" xs="12" Style="max-height: 65vh; overflow-y: auto;">
                <MudPaper Class="d-flex mb-1 px-8 py-3" Style="flex-direction: row; align-items: center;">
                    <MudStack Class="flex-grow-1" Row="false" Justify="Justify.FlexStart" AlignItems="AlignItems.Center">
                        <MudStack Row Justify="Justify.FlexStart" AlignItems="AlignItems.Center" Style="width: 100%;">
                            <MudText Class="open-sans-600 bold" Color="Color.Primary" Align="Align.Left">@experience.Category</MudText> <MudText Class="open-sans-600 bold" Color="Color.Primary" Align="Align.Left"> | </MudText> <MudText Class="open-sans-600 bold" Color="@(Layout.IsDarkMode ? Color.Default : Color.Dark)" Align="Align.Left">@experience.Title</MudText>
                        </MudStack>
                        <MudStack Class="flex-grow-1" Row Justify="Justify.FlexStart" AlignItems="AlignItems.Center" Style="width: 100%;">
                            <MudText Class="open-sans-600" Align="Align.Left">@experience.StartsAt.ToString("MM-yyyy")</MudText>
                            @if (experience.EndsAt.HasValue)
                            {
                                <MudText Class="open-sans-600" Align="Align.Left"> - </MudText> <MudText Class="open-sans-600" Align="Align.Left">@experience.EndsAt.Value.ToString("MM-yyyy")</MudText>
                            }
                        </MudStack>
                        @if (!string.IsNullOrWhiteSpace(experience.Description))
                        {
                            <MudStack Row="false" Spacing="0" Style="width: 100%;">
                                @foreach (var line in experience.Description.Split("\n"))
                                {
                                    <MudText Class="open-sans-600" Typo="Typo.subtitle2" Align="Align.Left">@line</MudText>
                                }
                            </MudStack>
                        }
                    </MudStack>
                    <MudStack Class="flex-grow-0" Row AlignItems="AlignItems.Center">
                        <MudStack Row="false" AlignItems="AlignItems.Center">
                            <MudIconButton Icon="@IconsF.Edit" Color="Color.Primary" OnClick="@(async () => await EditExperienceAsync(experience))"/>
                        </MudStack>
                        <MudStack Row="false" AlignItems="AlignItems.Center">
                            <MudIconButton Class="hover-red" Icon="@IconsF.Delete" Color="Color.Default" OnClick="@(async () => await DeleteExperienceAsync(experience))"/>
                        </MudStack>
                    </MudStack>
                </MudPaper>
            </MudItem>
        }
    </MudGrid>
</MudTabPanel>

